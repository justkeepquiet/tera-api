<%- contentFor("content") %>
<article class="content">
	<div class="title-block">
		<h1 class="title"><%= __("Shop Pay Logs") %></h1>
	</div>
	<%- include("partials/adminReportForm", { servers, from, to, serverId, accountDBID }) -%>
	<section class="section" style="display: none;">
		<div class="row">
			<div class="col-md-12">
				<div class="card">
					<div class="card-block">
						<section>
							<table class="table table-hover data-table-json mt-5">
								<thead>
									<tr>
										<th><%= __("ID") %></th>
										<th><%= __("Log time") %></th>
										<th><%= __("Account ID") %></th>
										<th><%= __("Server ID") %></th>
										<th><%= __("Product ID") %></th>
										<th><%= __("Box ID") %></th>
										<th><%= __("Price") %></th>
										<th><%= __("Status") %></th>
										<th><%= __("Updated") %></th>
									</tr>
								</thead>
							</table>
						</section>
					</div>
				</div>
			</div>
		</div>
	</section>
</article>
<%- contentFor("scripts") %>
<%_
const tableData = [];

logs.forEach(log => {
	tableData.push([
		log.get("id"),
		moment(log.get("createdAt")).tz(user.tz).format("YYYY-MM-DD HH:mm:ss"),
		log.get("accountDBID"),
		log.get("serverId"),
		`<a href="/shop_products/edit?id=${log.get("productId")}">${log.get("productId")}</a>`,
		log.get("boxId") || "-",
		log.get("price"),
		`<span class="text-${log.get("status") == "completed" ? "success" : "danger"}">${__(log.get("status"))}</span>`,
		moment(log.get("updatedAt")).tz(user.tz).format("YYYY-MM-DD HH:mm:ss")
	]);
});
_%>
<script>
	var serializedTable = <%- JSON.stringify(tableData) %>;
	$(function() {
		$(".data-table-json").DataTable($.extend({}, dataTablesSettings, {
			data: serializedTable,
			order: [[0, "desc"]]
		}));
		$(".dataTables_length select, .dataTables_filter input").each(function() {
			$(this).addClass("boxed");
		});
		$(".section").show();
	});
</script>